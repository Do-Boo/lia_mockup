<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LIA AI 메시지 생성 플로우 목업</title>
    <!-- Google Fonts (Noto Sans KR) 로드 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap"
        rel="stylesheet">
    <!-- Hugeicons CDN 로드 -->
    <link rel="stylesheet" href="https://cdn.hugeicons.com/font/hgi-stroke-rounded.css" />
    <style>
        /* --- CSS 변수 정의 (LIA 디자인 시스템 기반) --- */
        :root {
            --primary: #FF70A6;
            --accent: #A162F7;
            --yellow: #FFD670;
            --success: #28a745;
            --text-primary-light: #1A1A1A;
            --text-secondary-light: #3A3A3A;
            --text-tertiary-light: #718096;
            --background-color-light: #f8f9fa;
            --surface-light: #FFFFFF;
            --border-color-light: #e9ecef;
            --light-gray-light: #F1F3F5;
            --card-bg-pink-light: #FFF8FB;
            --card-bg-purple-light: #F6F0FF;

            /* 기본 라이트 모드로 설정 */
            --text-primary: var(--text-primary-light);
            --text-secondary: var(--text-secondary-light);
            --text-tertiary: var(--text-tertiary-light);
            --background-color: var(--background-color-light);
            --surface: var(--surface-light);
            --border-color: var(--border-color-light);
            --light-gray: var(--light-gray-light);
            --card-bg-pink: var(--card-bg-pink-light);
            --card-bg-purple: var(--card-bg-purple-light);
        }

        /* --- 기본 스타일 --- */
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: var(--background-color);
            color: var(--text-primary);
            margin: 0;
        }

        /* --- App Layout (수정됨) --- */
        .app-container {
            max-width: 420px;
            margin: 0 auto;
            background-color: var(--surface);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            /* 하단 푸터가 main-content를 가리지 않도록 padding 추가 */
            padding-bottom: 85px;
            box-sizing: border-box;
        }

        .main-content {
            flex-grow: 1;
            padding: 1.5rem;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* --- 상단 네비게이션 --- */
        .top-nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 1.5rem;
            background-color: var(--surface);
            border-bottom: 1px solid var(--border-color);
            flex-shrink: 0;
            position: relative;
        }

        .top-nav .icon {
            font-size: 1.5rem;
            color: var(--text-tertiary);
            cursor: pointer;
        }

        .top-nav-title {
            font-size: 1.25rem;
            font-weight: 700;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }

        /* --- 진행 단계 표시 (Stepper) --- */
        .progress-wrapper {
            display: flex;
            justify-content: space-between;
            padding: 1rem 1.5rem;
            background-color: var(--surface);
            border-bottom: 1px solid var(--border-color);
        }

        .progress-step {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-tertiary);
            font-weight: 500;
        }

        .progress-step .circle {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 2px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .progress-step.active .circle {
            border-color: var(--primary);
            background-color: var(--primary);
            color: white;
        }

        .progress-step.active span {
            color: var(--text-primary);
            font-weight: 700;
        }

        /* --- 섹션 제목 --- */
        .section-title {
            font-size: 1.25rem;
            font-weight: 900;
            margin: 0 0 1rem 0;
        }

        .section-title .highlight {
            color: var(--primary);
        }

        /* --- 프로필 카드 (1단계) --- */
        .profile-card-list {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            padding-bottom: 1rem;
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .profile-card-list::-webkit-scrollbar {
            display: none;
        }

        .profile-card {
            flex: 0 0 120px;
            border: 2px solid var(--border-color);
            border-radius: 0.75rem;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .profile-card img {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            margin-bottom: 0.5rem;
        }

        .profile-card h3 {
            font-size: 0.9rem;
            margin: 0;
            font-weight: 700;
        }

        .profile-card p {
            font-size: 0.75rem;
            color: var(--text-tertiary);
            margin: 0.25rem 0 0;
        }

        .profile-card.selected {
            border-color: var(--primary);
            background-color: var(--card-bg-pink);
            box-shadow: 0 4px 10px rgba(255, 112, 166, 0.2);
        }

        /* --- 칩 (1단계) --- */
        .chip-group {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-bottom: 2.5rem;
        }

        .chip {
            padding: 0.6rem 1.25rem;
            border-radius: 9999px;
            background-color: var(--light-gray);
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            border: 1px solid transparent;
            transition: all 0.2s ease;
        }

        .chip.selected {
            background-color: var(--primary);
            color: white;
            font-weight: 700;
            border-color: var(--primary);
        }

        /* --- 로딩 화면 (2단계 진입 시) --- */
        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            height: 100%;
            padding: 2rem;
        }

        .loading-spinner {
            width: 48px;
            height: 48px;
            border: 5px solid var(--light-gray);
            border-bottom-color: var(--primary);
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }

        @keyframes rotation {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .loading-container p {
            margin-top: 1.5rem;
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--text-secondary);
        }

        /* --- 메시지 제안 카드 (2단계) --- */
        .suggestion-card {
            background-color: var(--surface);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .suggestion-card.selected {
            border-color: var(--primary);
            background-color: var(--card-bg-pink);
            box-shadow: 0 4px 10px rgba(255, 112, 166, 0.2);
        }

        .suggestion-card .style-tag {
            background-color: var(--accent);
            color: white;
            padding: 0.25rem 0.75rem;
            font-size: 0.75rem;
            font-weight: 700;
            border-radius: 9999px;
            display: inline-block;
            margin-bottom: 1rem;
        }

        .suggestion-card .message-preview {
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 1rem;
            color: var(--text-secondary);
        }

        .suggestion-card .reaction-prediction {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            color: var(--text-tertiary);
        }

        .reaction-prediction .icon {
            color: var(--success);
        }

        /* --- 메시지 편집기 (3단계) --- */
        .textarea-field {
            width: 100%;
            background-color: var(--light-gray);
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            font-size: 1rem;
            box-sizing: border-box;
            color: var(--text-primary);
            padding: 1rem;
            font-family: 'Noto Sans KR', sans-serif;
            resize: none;
            min-height: 200px;
            margin-bottom: 1.5rem;
        }

        .textarea-field:focus {
            outline: none;
            border-color: var(--primary);
            background-color: var(--surface);
            box-shadow: 0 0 0 2px rgba(255, 112, 166, 0.2);
        }

        .assist-title {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--text-secondary);
            margin-bottom: 0.75rem;
        }

        .assist-title .icon {
            font-size: 1.1rem;
            color: var(--accent);
            vertical-align: bottom;
        }

        .chip-group.assist .chip {
            background-color: var(--surface);
            color: var(--accent);
            border-color: var(--accent);
        }

        /* --- 하단 고정 버튼 (수정됨) --- */
        .sticky-footer {
            padding: 1rem 1.5rem;
            background-color: var(--surface);
            border-top: 1px solid var(--border-color);
            position: fixed;
            /* 화면 하단에 고정 */
            bottom: 0;
            left: 0;
            right: 0;
            max-width: 420px;
            margin: 0 auto;
            box-sizing: border-box;
        }

        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.875rem 1.5rem;
            border-radius: 0.75rem;
            border: 1px solid transparent;
            font-weight: 700;
            cursor: pointer;
            font-size: 1rem;
            width: 100%;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn:disabled {
            background-color: var(--light-gray);
            color: var(--text-tertiary);
            cursor: not-allowed;
        }

        .btn-group {
            display: flex;
            gap: 0.75rem;
        }

        .btn-secondary {
            background-color: var(--light-gray);
            color: var(--text-primary);
            flex: 1;
        }

        .btn-primary.split {
            flex: 2;
        }

        /* --- Active 상태 효과 (추가됨) --- */
        .profile-card:active,
        .chip:active,
        .suggestion-card:active,
        .btn:active {
            transform: scale(0.98);
            filter: brightness(0.95);
        }
    </style>
</head>

<body>
    <div class="app-container">
        <!-- 상단 네비게이션 -->
        <nav class="top-nav">
            <i class="icon hgi-stroke hgi-arrow-left-02" id="exitBtn"></i>
            <h1 class="top-nav-title" id="pageTitle">메시지 생성</h1>
            <i class="icon hgi-stroke hgi-close"></i>
        </nav>

        <!-- 진행 단계 -->
        <div class="progress-wrapper" id="progressWrapper">
            <div class="progress-step active" id="progressStep1">
                <div class="circle">1</div> <span>상황 설정</span>
            </div>
            <div class="progress-step" id="progressStep2">
                <div class="circle">2</div> <span>메시지 선택</span>
            </div>
            <div class="progress-step" id="progressStep3">
                <div class="circle">3</div> <span>완성하기</span>
            </div>
        </div>

        <!-- 메인 컨텐츠 영역 -->
        <main class="main-content" id="mainContent">
            <!-- 각 단계별 컨텐츠가 여기에 동적으로 삽입됩니다. -->
        </main>

        <!-- 하단 고정 버튼 -->
        <div class="sticky-footer" id="footer">
            <!-- 각 단계별 버튼이 여기에 동적으로 삽입됩니다. -->
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DOM 요소 ---
            const mainContent = document.getElementById('mainContent');
            const footer = document.getElementById('footer');
            const pageTitle = document.getElementById('pageTitle');
            const exitBtn = document.getElementById('exitBtn');
            const progressWrapper = document.getElementById('progressWrapper');
            const progressSteps = [
                document.getElementById('progressStep1'),
                document.getElementById('progressStep2'),
                document.getElementById('progressStep3'),
            ];

            // --- 데이터 저장소 ---
            const selections = {
                target: null,
                situation: null,
                mood: null,
                chosenMessage: null,
            };

            // --- 현재 단계 관리 ---
            let currentStep = 1;

            // --- 단계별 렌더링 함수 ---

            function renderStep1() {
                currentStep = 1;
                updateProgress();
                mainContent.innerHTML = `
                    <div id="step1">
                        <h2 class="section-title">누구에게 보내나요?</h2>
                        <div class="profile-card-list" id="targetSelection">
                            <div class="profile-card" data-target="김민지">
                                <img src="https://placehold.co/96x96/FFACC7/FFFFFF?text=U" alt="김민지">
                                <h3>김민지</h3>
                                <p>INFP</p>
                            </div>
                            <div class="profile-card" data-target="이수현">
                                <img src="https://placehold.co/96x96/C9A7FF/FFFFFF?text=U" alt="이수현">
                                <h3>이수현</h3>
                                <p>ESTJ</p>
                            </div>
                            <div class="profile-card" data-target="박서준">
                                <img src="https://placehold.co/96x96/A0C4FF/FFFFFF?text=U" alt="박서준">
                                <h3>박서준</h3>
                                <p>모름</p>
                            </div>
                        </div>
                        <h2 class="section-title" style="margin-top: 2.5rem;">어떤 <span class="highlight">상황</span>인가요?</h2>
                        <div class="chip-group" id="situationSelection">
                            <div class="chip" data-situation="데이트 신청">#데이트 신청</div>
                            <div class="chip" data-situation="약속 잡기">#약속 잡기</div>
                            <div class="chip" data-situation="고백하기">#고백하기</div>
                            <div class="chip" data-situation="일상 안부">#일상 안부</div>
                            <div class="chip" data-situation="다툼 후 화해">#다툼 후 화해</div>
                        </div>
                        <h2 class="section-title">어떤 <span class="highlight">느낌</span>으로요?</h2>
                        <div class="chip-group" id="moodSelection">
                            <div class="chip" data-mood="유머러스하게">#유머러스하게</div>
                            <div class="chip" data-mood="진지하게">#진지하게</div>
                            <div class="chip" data-mood="로맨틱하게">#로맨틱하게</div>
                            <div class="chip" data-mood="따뜻하게">#따뜻하게</div>
                        </div>
                    </div>
                `;
                footer.innerHTML = `<button class="btn btn-primary" id="nextBtnStep1" disabled>다음으로</button>`;
                document.getElementById('nextBtnStep1').addEventListener('click', () => renderLoading());
                addStep1EventListeners();
                checkStep1Completion();
            }

            function renderLoading() {
                progressWrapper.style.display = 'none';
                mainContent.innerHTML = `
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                        <p>${selections.target} 님과의<br>'${selections.situation}' 상황에 맞는<br>메시지를 만들고 있어요!</p>
                    </div>
                `;
                footer.innerHTML = '';
                setTimeout(renderStep2, 2500);
            }

            function renderStep2() {
                currentStep = 2;
                progressWrapper.style.display = 'flex';
                updateProgress();
                mainContent.innerHTML = `
                    <div id="step2">
                        <h2 class="section-title">AI가 <span class="highlight">3가지</span> 메시지를 제안해요.</h2>
                        <div class="suggestion-card" data-message="민지님, 이번 주말에 시간 괜찮으세요? 같이 맛있는 거 먹으면서 얘기하고 싶어요! 혹시 파스타 좋아하세요?">
                            <div class="style-tag">#돌직구 스타일</div>
                            <p class="message-preview">민지님, 이번 주말에 시간 괜찮으세요? 같이 맛있는 거 먹으면서 얘기하고 싶어요! 혹시 파스타 좋아하세요?</p>
                            <div class="reaction-prediction"><i class="icon hgi-stroke hgi-like"></i>긍정적 반응 확률 85%</div>
                        </div>
                        <div class="suggestion-card" data-message="요즘 날씨도 좋은데, 주말에 뭐 하세요? 괜찮으시면 같이 새로 생긴 카페 가보는 거 어때요? 민지님이랑 가면 더 좋을 것 같아요.">
                            <div class="style-tag">#다정다감 스타일</div>
                            <p class="message-preview">요즘 날씨도 좋은데, 주말에 뭐 하세요? 괜찮으시면 같이 새로 생긴 카페 가보는 거 어때요? 민지님이랑 가면 더 좋을 것 같아요.</p>
                            <div class="reaction-prediction"><i class="icon hgi-stroke hgi-like"></i>긍정적 반응 확률 92%</div>
                        </div>
                        <div class="suggestion-card" data-message="속보입니다. 이번 주말, 민지님의 시간을 훔쳐갈 범인으로 제가 지목되었습니다. 순순히 약속에 응해주시죠! (찡긋)">
                            <div class="style-tag">#센스있는 유머 스타일</div>
                            <p class="message-preview">속보입니다. 이번 주말, 민지님의 시간을 훔쳐갈 범인으로 제가 지목되었습니다. 순순히 약속에 응해주시죠! (찡긋)</p>
                            <div class="reaction-prediction"><i class="icon hgi-stroke hgi-like"></i>긍정적 반응 확률 88%</div>
                        </div>
                    </div>
                `;
                footer.innerHTML = `
                    <div class="btn-group">
                        <button class="btn btn-secondary" id="backBtnStep2">뒤로가기</button>
                        <button class="btn btn-primary split" id="nextBtnStep2" disabled>다음으로</button>
                    </div>
                `;
                document.getElementById('backBtnStep2').addEventListener('click', () => renderStep1());
                document.getElementById('nextBtnStep2').addEventListener('click', () => renderStep3());
                addStep2EventListeners();
            }

            function renderStep3() {
                currentStep = 3;
                updateProgress();
                mainContent.innerHTML = `
                    <div id="step3">
                        <h2 class="section-title">메시지를 <span class="highlight">나만의 스타일</span>로 완성하세요.</h2>
                        <textarea class="textarea-field" id="messageEditor">${selections.chosenMessage}</textarea>
                        <p class="assist-title"><i class="icon hgi-stroke hgi-ai-beautify"></i> AI 어시스트</p>
                        <div class="chip-group assist">
                            <div class="chip">#좀 더 부드럽게</div>
                            <div class="chip">#이모티콘 추가해줘</div>
                            <div class="chip">#살짝만 더 장난스럽게</div>
                        </div>
                    </div>
                `;
                footer.innerHTML = `
                    <div class="btn-group">
                        <button class="btn btn-secondary" id="backBtnStep3">뒤로가기</button>
                        <button class="btn btn-primary split" id="copyBtn">복사 및 완료</button>
                    </div>
                `;
                document.getElementById('backBtnStep3').addEventListener('click', () => renderStep2());
                document.getElementById('copyBtn').addEventListener('click', () => {
                    const editor = document.getElementById('messageEditor');
                    navigator.clipboard.writeText(editor.value).then(() => {
                        alert('메시지가 복사되었습니다. 대화가 기록됩니다.');
                    });
                });
            }

            function addStep1EventListeners() {
                document.getElementById('targetSelection').addEventListener('click', (e) => {
                    const card = e.target.closest('.profile-card');
                    if (card) {
                        document.querySelectorAll('#targetSelection .profile-card').forEach(c => c.classList.remove('selected'));
                        card.classList.add('selected');
                        selections.target = card.dataset.target;
                        checkStep1Completion();
                    }
                });
                document.getElementById('situationSelection').addEventListener('click', (e) => {
                    const chip = e.target.closest('.chip');
                    if (chip) {
                        document.querySelectorAll('#situationSelection .chip').forEach(c => c.classList.remove('selected'));
                        chip.classList.add('selected');
                        selections.situation = chip.dataset.situation;
                        checkStep1Completion();
                    }
                });
                document.getElementById('moodSelection').addEventListener('click', (e) => {
                    const chip = e.target.closest('.chip');
                    if (chip) {
                        document.querySelectorAll('#moodSelection .chip').forEach(c => c.classList.remove('selected'));
                        chip.classList.add('selected');
                        selections.mood = chip.dataset.mood;
                        checkStep1Completion();
                    }
                });
            }

            function addStep2EventListeners() {
                document.querySelectorAll('.suggestion-card').forEach(card => {
                    card.addEventListener('click', () => {
                        document.querySelectorAll('.suggestion-card').forEach(c => c.classList.remove('selected'));
                        card.classList.add('selected');
                        selections.chosenMessage = card.dataset.message;
                        document.getElementById('nextBtnStep2').disabled = false;
                    });
                });
            }

            function checkStep1Completion() {
                const nextBtn = document.getElementById('nextBtnStep1');
                if (selections.target && selections.situation && selections.mood) {
                    nextBtn.disabled = false;
                } else {
                    nextBtn.disabled = true;
                }
            }

            function updateProgress() {
                pageTitle.textContent = ['상황 설정', 'AI 제안', '메시지 완성'][currentStep - 1];
                progressSteps.forEach((step, index) => {
                    if (index < currentStep) {
                        step.classList.add('active');
                    } else {
                        step.classList.remove('active');
                    }
                });
            }

            exitBtn.addEventListener('click', () => {
                alert('메시지 생성을 종료하고 이전 페이지로 돌아갑니다.');
                // 예: location.href = '/previous-page';
            });

            // --- 앱 시작 ---
            renderStep1();
        });
    </script>
</body>

</html>